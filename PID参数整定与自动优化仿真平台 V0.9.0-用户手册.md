# PID参数整定与自动优化仿真平台 V0.9.0-用户手册

**软件版本:** 0.9.0<br>
**作者:** 周文晋，张玮<br>
**发布日期:** 2025年11月16日<br>
**适用对象:** 化工过程控制、自动化及相关专业学生、教师及工程师

## 目录

- [PID参数整定与自动优化仿真平台 V0.9.0-用户手册](#pid参数整定与自动优化仿真平台-v090-用户手册)
  - [目录](#目录)
  - [1. 简介](#1-简介)
    - [1.1 项目概述](#11-项目概述)
    - [1.2 核心功能](#12-核心功能)
    - [1.3 当前版本限制](#13-当前版本限制)
  - [2. 界面布局与功能区介绍](#2-界面布局与功能区介绍)
    - [A. 仿真输入区](#a-仿真输入区)
    - [B. 仿真控制区](#b-仿真控制区)
    - [C. 仿真输出区](#c-仿真输出区)
  - [3. 典型教学与实践场景](#3-典型教学与实践场景)
    - [场景一: 纯比例(P)作用与静差](#场景一-纯比例p作用与静差)
    - [场景二: 比例积分(PI)作用消除静差](#场景二-比例积分pi作用消除静差)
    - [场景三: 纯滞后(Delay)的破坏性](#场景三-纯滞后delay的破坏性)
    - [场景四: 现代自动整定 vs. 手动试凑](#场景四-现代自动整定-vs-手动试凑)
    - [场景五: 参数不当引起的系统失稳 (V0.9.0 新增)](#场景五-参数不当引起的系统失稳-v090-新增)
  - [4. 更新日志](#4-更新日志)
  - [5. 未来展望 (V1.0 计划)](#5-未来展望-v10-计划)

---

## 1. 简介

### 1.1 项目概述

“PID参数整定与自动优化仿真平台”是一款基于Web技术的交互式仿真工具，专为《化工仪表及自动化》等课程的教学与实践而设计。本平台旨在帮助用户深刻理解PID控制原理，掌握手动调参技巧，并体验现代控制工程中先进的参数自动优化方法。

用户无需安装任何软件，仅通过浏览器即可对两种典型的被控对象进行PID控制仿真，并利用集成的“响应优化”算法一键获取当前工况下的最优PI控制参数。

本平台采用标准Web技术(HTML5/CSS3/JavaScript)构建，无需任何插件或后端支持，可以作为一个独立的交互式模块，无缝嵌入到各类数字教材、在线课程平台(如Moodle)、或教学PPT中。它将传统教材中静态的PID曲线图，升级为可由学生亲手操作、实时反馈的“动态实验室”，极大地提升了教学的互动性和趣味性。

### 1.2 核心功能

* **实时动态仿真**：对给定被控对象进行闭环PID控制，并实时绘制SP(设定值)、PV(过程值)、OP(控制器输出)响应曲线。
* **参数手动整定**：用户可自由设置P (Kc)、I(Ti)、D(Td)参数，直观感受不同参数对控制效果的影响。
* **一键自动整定**：集成基于响应优化的先进算法，能够自动为当前被控对象(包括纯滞后)计算出一组性能卓越的PI参数。
* **模型切换**：支持两种典型的化工过程模型：
    * 一阶过阻尼对象: $1 / (5s + 1)$
    * 二阶欠阻尼对象: $25 / (s^2 + 3s + 25)$
* **纯滞后模拟**：可任意设置过程的纯滞后时间，研究其对系统稳定性和控制难度的影响。
* **自定义仿真时间**：可设置仿真的总时长，观察系统的长周期响应。

### 1.3 当前版本限制

本平台V0.9.0版本主要用于教学和演示，存在以下限制：

* **被控对象固定**：目前仅支持内置的两个经典传递函数模型。
* **自动整定范围**：自动优化算法当前主要针对PI控制器进行整定(Td=0)，这是因为在绝大多数工业应用场景中，PI控制器是性能与鲁棒性最佳的平衡选择。

---

## 2. 界面布局与功能区介绍

本平台界面主要分为三个区域：A. 仿真输入区，B. 仿真控制区，和 C. 仿真输出区。

### A. 仿真输入区

此区域用于设置仿真的所有前提条件。

1.  **控制器参数(PID)**
    * **Kc (增益)**：比例增益, 决定控制器对误差的反应强度。
        * *V0.8.4 提示*：Kc 必须大于0。若输入0, 系统将提示控制器无输出并自动重置为1.0。
    * **Ti (积分时间, s)**：积分时间, 用于消除静差。数值越小, 积分作用越强。
        * *V0.8.3 提示*：Ti必须大于0 (因为是分母)。输入9999表示无穷大, 即关闭积分作用(纯P或PD控制)。若输入0, 系统将提示并自动重置为9999。
    * **Td (微分时间, s)**：微分时间, 用于提供预测作用以抑制超调。

2.  **被控对象(Process)**
    * **模型选择**：通过单选按钮选择要进行仿真的被控对象。
        * **一阶对象**：代表一个简单的、响应平缓的“大惯性”过程(如储罐液位)。
        * **二阶对象**：代表一个响应迅速、带振荡特性的复杂过程(如反应器温度)。
    * **纯滞后(Delay, s)**：设置过程的传输延迟时间。这是影响系统稳定性的关键因素。

3.  **仿真设置**
    * **仿真时间(s)**：设置C区图表的横坐标(时间轴)最大值, 用于观察长周期的响应。默认值为50s。

### B. 仿真控制区

此区域用于启动仿真和执行自动整定。

* **[运行仿真(手动)] 按钮**
    点击此按钮, 系统将使用A区当前所有输入框中的参数进行一次完整的闭环控制仿真, 并在C区绘制结果曲线。
    * ***V0.8.8 提示 (新!)***：点击此按钮后, B区下方的**[参数结果]框**(见V0.9.0提示)将平滑出现, 并显示您当前手动输入的`Kc`, `Ti`, `Td`值, 标题为“**当前手动参数:**”。
* **[参数自动整定(Auto-Tune)] 按钮**
    点击此按钮, 系统将启动内置的响应优化算法。
    算法在后台进行数十次迭代计算, 以寻找能使综合性能指标(ITAE、超调、调节时间等)最优的PI参数组合。
    整个过程伴有实时状态反馈：
    * **状态框**：会平滑地出现, 并分阶段显示“识别近似模型”、“进行响应优化”, 同时实时更新迭代进度和当前找到的最优成本值。
    * **结果框**：优化完成后, 状态框会平滑消失, **中立的石板灰色[参数结果]框**出现, 清晰地展示优化得到的Kc和Ti值, 标题为“**自动整定结果:**”。
    * ***V0.8.7 提示***：为避免歧义, 当您更改“被控对象”(即切换模型或修改“纯滞后”时间)后, 此结果框会自动隐藏, 因为它显示的参数是针对**上一个**被控对象的。
    * ***V0.9.0 提示 (界面更新)***：为在视觉上统一功能, V0.9.0将此“结果框”的颜色从自动整定的**绿色**修改为**中立的石板灰色**。它现在是一个共享的“信息输出”框, 无论由“手动”还是“自动”触发。

### C. 仿真输出区

此区域使用Plotly.js动态绘制高质量的仿真响应曲线。

* ***V0.8.9 提示 (教学逻辑更新)***：为提升教学的互动性和主动性, V0.8.9版开始, **平台启动时C区将显示一个空的图表框架**。用户必须主动点击任一仿真按钮(手动或自动)才会开始绘制曲线, 这鼓励了主动探索。

* **SP (设定值)**：黑色虚线, 表示我们希望过程达到的目标值。
* **PV (过程值)**：蓝色实线, 表示被控变量的实际响应。
* **OP (控制器输出)**：红色实线, 显示在右侧Y轴, 表示控制器为了驱动PV去跟踪SP而输出的控制信号。
    * *V0.8.5 提示*：OP曲线及其Y坐标轴默认隐藏, 以突出PV响应曲线。您只需单击图表上方的图例“OP (控制器输出)”, 即可**同时显示**或再次隐藏曲线与坐标轴。

**图表交互功能详解**
C区的仿真输出图表是完全交互式的。将鼠标悬停在图表右上角, 会显示一排工具栏图标：

* **下载图表**：点击可将当前视图保存为PNG图像文件。
* **放大**：点击激活后, 在图表上按住鼠标左键拖出一个矩形区域, 松开后即可放大该区域。
* **平移**：点击激活后, 按住鼠标左键可拖动平移整个图表(在放大后尤其有用)。
* **缩放按钮**：点击“+”/“-”按钮可逐步放大或缩小图表中心。
* **重置视图**：无论图表被如何放大或平移, 点击此按钮都会立即恢复到默认的完整视图。
* **双击图表**：效果与点击“重置视图”相同, 是快速恢复视图的快捷方式。
* **单击图例**：在图表上方的图例(如 SP (设定值))上单击, 可以切换对应曲线的显示或隐藏。
* **鼠标滚轮**：在图表上滚动鼠标滚轮, 可以快速缩放时间轴(X轴)。

---

## 3. 典型教学与实践场景

本平台特别适合用于以下教学场景的探索与验证：

### 场景一: 纯比例(P)作用与静差

* **设置**：$Ti = 9999$, $Td = 0.0$。
* **观察**：PV响应迅速, 但最终无法与SP重合, 存在一个无法消除的稳态误差(静差)。改变Kc值, 观察静差大小的变化。

### 场景二: 比例积分(PI)作用消除静差

* **设置**：在场景一基础上, 将Ti从一个较大值(如50)逐渐减小。
* **观察**：随着Ti减小, 静差被逐渐消除, 但系统可能会出现超调和振荡。

### 场景三: 纯滞后(Delay)的破坏性

* **设置**：使用一组效果不错的PI参数, 将Delay从0逐渐增大(如 $Delay=2, 5, 10$)。
* **观察**：随着纯滞后的增加, 系统变得越来越不稳定, 最终产生持续振荡。这直观地展示了纯滞后是控制系统中最不利的因素。

### 场景四: 现代自动整定 vs. 手动试凑

* **设置**：选择最难控制的二阶对象, 并设置一个较大的纯滞后(如 $Delay = 3.0$)。
* **手动尝试**：让学生先手动尝试整定Kc和Ti参数, 他们会发现很难在快速响应和避免振荡之间取得良好平衡。
* **一键优化**：清空参数, 直接点击 [参数自动整定] 按钮。
* **对比与结论**：观察优化算法给出的参数和响应曲线。学生会发现, 算法不仅快速, 而且找到的参数组合往往能实现远优于手动试凑的控制效果。这深刻地揭示了现代控制算法在解决复杂工程问题中的强大威力。

### 场景五: 参数不当引起的系统失稳 (V0.9.0 新增)

* **背景**：此场景演示了不合理的参数(特别是过强的积分和过大的滞后)如何导致系统从稳定变为持续振荡(失稳)。
* **设置**：
    * **控制器参数**: `Kc=1`, `Ti=1`, `Td=0`
    * **被控对象**: "二阶对象: 25/(s²+3s+25)"
    * **纯滞后**: `Delay = 1.0`
* **观察**：点击 [运行仿真(手动)]。
* **分析**：曲线将显示一个等幅、持续的剧烈振荡。这是因为：
    1.  **对象特性**："二阶对象"本身是一个快速响应的欠阻尼系统, 有振荡倾向。
    2.  **激进的积分**：`Ti=1`的积分作用非常激进(积分时间极短)。
    3.  **巨大的滞后**：`Delay=1.0`的滞后对于这个快速系统而言非常巨大。
* **结论**：控制器总是在对1秒前的“幻影”进行猛烈修正, 导致其修正永远滞后于系统的实际状态, 最终引发了极限环振荡。这个案例直观地展示了参数设置不当的严重后果。

---

## 4. 更新日志

**V0.9.0 (2025.11.16)**
* **界面**：为实现功能统一, 将手动仿真和自动整定共用的“参数结果”框的颜色, 从 V0.8.7 的绿色改为**中立的石板灰色**, 使其作为统一的信息输出框, 避免与绿色“自动整定”按钮混淆。
   
**V0.8.9 (2025.11.16)**
* **教学逻辑**：平台加载时不再自动运行仿真。C区现在显示一个“空图表框架”, 等待用户主动点击按钮。这强化了“操作-反馈”的教学闭环, 提升了主动探索体验。

**V0.8.8 (2025.11.16)**
* **界面联动**：增强[运行仿真(手动)]按钮的功能。点击后, 下方的共享信息框会激活, 并显示当前手动的PID参数, 标题为“当前手动参数:”, 以供学生确认。

**V0.8.7 (2025.11.16)**
* **改进**：提升用户体验, 避免误解。当用户在自动整定后, 又修改了“被控对象”(如切换模型或更改纯滞后时间), 系统会自动隐藏过时(Stale)的整定结果框, 防止用户将其误认为是当前对象的参数。

**V0.8.5 (2025.11.15)**
* **改进**：优化OP坐标轴的显示逻辑。现在不仅OP曲线默认隐藏，其对应的右侧OP坐标轴 (Y-axis 2) 也默认隐藏。点击图例可将二者同时显示或隐藏，使初始图表界面更简洁。
  
**V0.8.4 (2025.11.14)**
* **功能**：运行仿真时增加 Kc 的合法性验证。若 $Kc \le 0$，则弹窗提示控制器无输出并自动重置为 $Kc=1.0$，避免仿真曲线为一条直线。
* **优化**：将控制器输出(OP)曲线设置为默认隐藏 (legendonly)，使用户能更专注于PV响应曲线。用户可通过单击图例轻松开启显示。

**V0.8.3 (2025.11.12)**
* **功能**：在“仿真输入区”增加“仿真设置”，允许用户自定义仿真时间, 以动态控制图表X轴的长度。
* **功能**：运行仿真时增加 Ti 的合法性验证。若 $Ti \le 0$，则弹窗提示必须大于0并自动重置为9999(关闭积分)，避免了除零错误。
* **修复**：修正了图表 yaxis2 (OP轴) 的刻度对齐问题。通过调整 range, 使其0刻度线与 yaxis (PV/SP轴)的0刻度线完美对齐。

**V0.8.1 (2025.11.10)**
* **功能**：集成基于Nelder-Mead (单纯形法) 响应优化的自动整定器，可一键优化PI参数。

**V0.8.0 (2025.11.09)**
* **功能**：平台初始版本发布。
* **功能**：包含手动参数输入、两种被控对象模型(一阶、二阶)切换、纯滞后设置功能。

---

## 5. 未来展望 (V1.0 计划)

为进一步提升平台的专业性和教学价值，后续版本计划增加以下功能：

* **可自定义的被控对象**：允许用户直接输入传递函数参数($K_p, T_p, \theta_p$ 等)。
* **PID整定支持**：将自动优化算法扩展至完整的PID控制器, 在需要时给出建议。
* **更多整定规则对比**：内置Ziegler-Nichols (Z-N) 法、Cohen-Coon (C-C) 法等经典规则, 与现代优化法进行效果对比。
* **抗扰动性能仿真**：增加在系统中施加负载扰动的功能, 以测试参数的鲁棒性。