# PID参数整定与自动优化仿真平台 V0.14.2-用户手册

**软件版本:** 0.14.2<br>
**作者:** 周文晋，张玮<br>
**发布日期:** 2025年11月18日<br>
**适用对象:** 化工过程控制、自动化及相关专业学生、教师及工程师

## 目录

- [PID参数整定与自动优化仿真平台 V0.14.2-用户手册](#pid参数整定与自动优化仿真平台-v0142-用户手册)
  - [目录](#目录)
  - [1. 简介](#1-简介)
    - [1.1 项目概述](#11-项目概述)
    - [1.2 核心功能](#12-核心功能)
    - [1.3 当前版本限制](#13-当前版本限制)
  - [2. 界面布局与功能区介绍](#2-界面布局与功能区介绍)
    - [A. 仿真输入区](#a-仿真输入区)
    - [B. 仿真控制区](#b-仿真控制区)
    - [C. 仿真输出区](#c-仿真输出区)
  - [3. 典型教学与实践场景](#3-典型教学与实践场景)
    - [场景一: 纯比例(P)作用与静差](#场景一-纯比例p作用与静差)
    - [场景二: 比例积分(PI)作用消除静差](#场景二-比例积分pi作用消除静差)
    - [场景三: 纯滞后(Delay)的破坏性](#场景三-纯滞后delay的破坏性)
    - [场景四: 现代自动整定 vs. 手动试凑](#场景四-现代自动整定-vs-手动试凑)
    - [场景五: 参数不当引起的系统失稳](#场景五-参数不当引起的系统失稳)
    - [场景六: 工程整定法实践——临界比例度法 (Ziegler-Nichols)](#场景六-工程整定法实践临界比例度法-ziegler-nichols)
  - [4. 更新日志](#4-更新日志)
  - [5. 未来展望 (V1.0 计划)](#5-未来展望-v10-计划)

---

## 1. 简介

### 1.1 项目概述

“PID参数整定与自动优化仿真平台”是一款基于Web技术的交互式仿真工具，专为《化工仪表及自动化》等课程的教学与实践而设计。本平台旨在帮助用户深刻理解PID控制原理，掌握手动调参技巧，并体验现代控制工程中先进的参数自动优化方法。

用户无需安装任何软件，仅通过浏览器即可对多种典型的被控对象进行PID控制仿真。特别是 **V0.13.0** 版本引入了物理意义明确的“换热器”对象，配合 **V0.14.2** 完善的稳态工作点逻辑，使用户能够模拟真实的化工过程控制场景。

本平台采用标准Web技术(HTML5/CSS3/JavaScript)构建，无需任何插件或后端支持，可以作为一个独立的交互式模块，无缝嵌入到各类数字教材、在线课程平台(如Moodle)、或教学PPT中。

### 1.2 核心功能

* **实时动态仿真**：对给定被控对象进行闭环PID控制，并实时绘制SP(设定值)、PV(过程值)、OP(控制器输出)响应曲线。
* **真实物理场景 (V0.13+)**：新增“换热器”温控模式，支持物理单位（温度°C、开度%）显示，并内置稳态工作点逻辑（Bias），模拟真实工况下的能量平衡。
* **参数手动整定**：用户可自由设置P (Kc)、I(Ti)、D(Td)参数，直观感受不同参数对控制效果的影响。
* **一键自动整定 (Auto-Tune)**：集成基于单纯形法（Nelder-Mead）的响应优化算法，能够自动为当前被控对象(包括纯滞后和物理对象)计算出一组性能卓越的 **完整PID参数 (Kc, Ti, Td)**。
* **智能教学预设**：切换至“换热器”模式时，系统会自动配置适合 Z-N 临界比例度法实验的参数（如延时、仿真时间、关闭I/D）。
* **模型切换**：支持三种典型的化工过程模型：
    * 一阶过阻尼对象: $1 / (5s + 1)$
    * 二阶欠阻尼对象: $25 / (s^2 + 3s + 25)$
    * **换热器 (V0.13+)**: FOPDT模型 ($K=1.2, T=10s, \tau=3s$)，带稳态偏置。
* **现实约束**：平台始终在 0-100% 的阀门开度约束下运行，模拟执行器饱和特性。

### 1.3 当前版本限制

本平台V0.14.2版本主要用于教学和演示，存在以下限制：

* **被控对象固定**：目前支持内置的三个经典传递函数模型。
* **算法适用性**：自动优化算法基于响应优化，在某些极端参数下可能收敛于局部最优解。

---

## 2. 界面布局与功能区介绍

本平台界面主要分为三个区域：A. 仿真输入区，B. 仿真控制区，和 C. 仿真输出区。

### A. 仿真输入区

此区域用于设置仿真的所有前提条件。

1.  **控制器参数(PID)**
    * **Kc (增益)**：比例增益。
    * **Ti (积分时间, s)**：积分时间。通过 **`[关闭积分]`** 复选框来启用或禁用。
    * **Td (微分时间, s)**：微分时间。通过 **`[关闭微分]`** 复选框来启用或禁用。

2.  **被控对象(Process)**
    * **模型选择**：
        * **一阶对象**：简单的“大惯性”过程(如储罐液位)。
        * **二阶对象**：响应迅速、带振荡特性的过程。
        * **换热器 (V0.13+)**：具有真实物理背景的温度控制对象。选中此项后，图表坐标轴将自动切换为温度(°C)和阀门开度(%)。
    * **纯滞后(Delay, s)**：设置过程的传输延迟时间。

3.  **仿真设置**
    * **仿真时间(s)**：设置C区图表的横坐标最大值。选中“换热器”时会自动延长至100s以适应慢速热过程。

### B. 仿真控制区

* **[运行仿真(手动)]**：使用当前参数进行一次仿真。
* **[参数自动整定(Auto-Tune)]**：启动后台优化算法。
    * **V0.14.2 特性**：自动整定算法已完全适配“换热器”模式，能够理解稳态工作点（Bias），不会在测试过程中错误地将阀门完全关闭导致温度骤降。

### C. 仿真输出区

* **交互式图表**：支持缩放、平移、下载。
* **智能坐标轴 (V0.14.0)**：
    * 普通模式：显示归一化数值 (0.0 - 1.5)。
    * 换热器模式：显示真实物理量 (温度 78-85°C，开度 0-100%)。
* **OP 曲线**：默认隐藏，点击图例可显示红色输出曲线，用于观察阀门动作及饱和现象（极限环）。

---

## 3. 典型教学与实践场景

### 场景一: 纯比例(P)作用与静差

* **设置**：
    * 勾选 **`[关闭积分]`**
    * 勾选 **`[关闭微分]`**
* **观察**：PV响应迅速, 但最终无法与SP重合, 存在一个无法消除的稳态误差(静差)。改变Kc值, 观察静差大小的变化。

### 场景二: 比例积分(PI)作用消除静差

* **设置**：在场景一基础上, **取消勾选** **`[关闭积分]`**。将Ti从一个较大值(如50)逐渐减小。
* **观察**：随着Ti减小, 静差被逐渐消除, 但系统可能会出现超调和振荡。

### 场景三: 纯滞后(Delay)的破坏性

* **设置**：使用一组效果不错的PID参数, 将Delay从0逐渐增大(如 $Delay=2, 5, 10$)。
* **观察**：随着纯滞后的增加, 系统变得越来越不稳定, 最终产生持续振荡。这直观地展示了纯滞后是控制系统中最不利的因素。

### 场景四: 现代自动整定 vs. 手动试凑

* **设置**：选择最难控制的二阶对象, 并设置一个较大的纯滞后(如 $Delay = 3.0$)。
* **手动尝试**：让学生先手动尝试整定 **Kc, Ti 和 Td** 三个参数。他们会很快发现, 三参数的手动试凑不仅耗时, 且极难在快速响应和避免振荡之间取得良好平衡。
* **一键优化**：清空参数, 直接点击 [参数自动整定] 按钮。
* **对比与结论**：观察优化算法给出的 **PID** 参数和响应曲线。学生会发现, 算法不仅快速, 而且找到的三参数组合往往能实现远优于手动试凑的控制效果（更小的超调、更短的调节时间）。这深刻地揭示了现代控制算法在解决复杂多维优化问题中的强大威力。

### 场景五: 参数不当引起的系统失稳

* **背景**：此场景演示了不合理的参数(特别是过强的积分和过大的滞后)如何导致系统从稳定变为持续振荡(失稳)。
* **设置**：
    * **控制器参数**: `Kc=1`, **取消勾选`[关闭积分]`** 并设置 `Ti=1`, 保持 `[关闭微分]` 勾选。
    * **被控对象**: "二阶对象: 25/(s²+3s+25)"
    * **纯滞后**: `Delay = 1.0`
* **观察**：点击 [运行仿真(手动)]。
* **分析**：曲线将显示一个等幅、持续的剧烈振荡。这是因为：
    1.  **对象特性**："二阶对象"本身是一个快速响应的欠阻尼系统, 有振荡倾向。
    2.  **激进的积分**：`Ti=1`的积分作用非常激进(积分时间极短)。
    3.  **巨大的滞后**：`Delay=1.0`的滞后对于这个快速系统而言非常巨大。
* **结论**：控制器总是在对1秒前的“幻影”进行猛烈修正, 导致其修正永远滞后于系统的实际状态, 最终引发了极限环振荡。这个案例直观地展示了参数设置不当的严重后果。

### 场景六: 工程整定法实践——临界比例度法 (Ziegler-Nichols)

* **背景**：本场景利用 V0.13+ 版本引入的“换热器”对象，模拟真实的工程整定过程。目标是获取 **4:1 衰减振荡** 的理想控制效果。
* **步骤 1：测取临界参数**
    * 选择 **“换热器”** 对象（系统自动预设 Delay=3.0s, Time=100s, 关闭积分, 关闭微分）。
    * 将 $K_c$ 逐渐增大，直到系统产生**等幅振荡**。
    * **实验结果**：当 $K_c = 4.9$ 时，系统处于临界状态。此时测得临界周期 $T_k \approx 10.8s$。
* **步骤 2：计算 PI 参数**
    * 根据 Z-N 公式（PI控制）：
        * 临界比例度 $\delta_k = (1/4.9) \times 100\% \approx 20.4\%$
        * 设定比例度 $\delta = 2.2 \delta_k \approx 44.9\%$ $\rightarrow$ $K_c \approx 2.23$
        * 设定积分时间 $T_i = 0.85 T_k \approx 9.18s$
    * 输入参数：$K_c=2.23, T_i=9.18, T_d=0$。
* **步骤 3：观察与工程修正**
    * 运行仿真，发现系统虽然稳定，但衰减比约为 10:1，过于保守（过渡过程太慢）。
    * **工程修正**：为了获得更快的响应（4:1 衰减），适当增加增益。
    * 将 $K_c$ 调整为 **2.8**。
* **最终效果**：观察到完美的 **4:1 衰减振荡** 曲线，第一个波峰约为 83.1°C，第二个波峰约为 82.25°C，超调量比值约为 1:4，达到工程理想状态。

---

## 4. 更新日志

**V0.14.2 (2025.11.18)**
* **算法修复**：完全修复了 V0.14.0 版本中因简化导致的自动整定算法缺失问题，恢复了完整的 Nelder-Mead 单纯形法逻辑。
* **算法优化**：确保自动整定器在进行阶跃测试和成本评估时，能够正确处理物理模型的稳态偏置（Bias），避免了错误的“关死阀门”操作。
* **UI 微调**：简化了左侧模型选择区的文案显示。

**V0.14.1 (2025.11.18)**
* **紧急修复**：补全了 V0.14.0 中遗漏的核心优化循环代码，确保自动整定功能可用。

**V0.14.0 (2025.11.18)**
* **物理修正 (核心)**：针对“换热器”对象引入了 **稳态工作点 (Operating Point Bias)** 概念。
    * 设定稳态时阀门开度为 40% (对应 80°C)，修正了此前 $OP=0$ 维持高温的物理悖论。
    * PID 算法更新为 $OP = P + I + D + Bias$。
* **交互优化**：解决了切换模型时图表坐标轴更新滞后的问题，现在点击单选框即可立即刷新坐标轴量程。

**V0.13.0 (2025.11.17)**
* **新增模型**：增加了 **“换热器”** 被控对象。
    * 模型特性：FOPDT ($K=1.2, T=10s, \tau=3s$)。
    * 物理环境：温度控制（80°C -> 82°C），带有真实的物理单位。
* **智能预设**：选中换热器模式时，自动配置 Z-N 法实验所需的参数环境（延时 3s，仿真时间 100s，强制 P-Only 模式）。
* **教学验证**：该模型完美支持演示 Z-N 临界比例度法，可复现 $K_c=4.9$ 时的等幅振荡及执行器饱和导致的极限环现象。

**V0.12.1 (2025.11.16)**
* **界面简化**：移除了 "启用现实约束" 复选框，平台现在始终在 0-100% 的现实约束下运行。
* **算法改进**：优化了自动整定器的初始猜测策略，结合 IMC 和 Z-N 规则提升收敛速度。
* **算法改进**：`AutoTuner` 迭代次数增加至 200 次，停滞容忍度增加至 50 次。

**V0.11.0 (2025.11.16)**
* **核心升级 (Auto-Tune)**: 自动整定算法从PI (2D) 优化 **重大升级为完整的 PID (3D) 优化**。
* **算法**: 初始参数猜测法从 PI 规则改为经典的 **Ziegler-Nichols (Z-N) 阶跃响应法**。
* **界面 (UI)**: 新增 **`[关闭微分]`** 复选框，与 "关闭积分" 统一。

**V0.10.0 (2025.11.16)**
* **功能**: 新增 **"启用现实约束"** (OP 限制 0%-100%) 模式（注：V0.12.1已改为强制启用）。
* **修复 (核心)**: 修复了自动整定器 (`AutoTuner`) 在理想模式下会找到错误最优解的 Bug。
* **界面 (UI)**: 引入 **`[关闭积分]`** 复选框 (`ti-infinite`)，取代了 "9999" 的约定。

**V0.9.0 (2025.11.16)**
* **界面**：将“参数结果”框颜色改为中立的石板灰色。
* **教学逻辑**：平台加载时不再自动运行仿真。

**V0.8.7 (2025.11.16)**
* **改进**：修改“被控对象”会自动隐藏过时的整定结果框。

**V0.8.5 (2025.11.15)**
* **改进**：OP曲线及右侧坐标轴默认隐藏。

**V0.8.4 (2025.11.14)**
* **功能**：增加 Kc 的合法性验证（需 > 0）。

**V0.8.3 (2025.11.12)**
* **功能**：增加“仿真时间”自定义设置。
* **功能**：增加 Ti 的合法性验证。

**V0.8.1 (2025.11.10)**
* **功能**：集成Nelder-Mead自动整定器。

**V0.8.0 (2025.11.09)**
* **功能**：平台初始版本发布。

---

## 5. 未来展望 (V1.0 计划)

* **可自定义的被控对象**：允许用户直接输入传递函数参数($K_p, T_p, \theta_p$ 等)。
* **更多整定规则对比**：内置Ziegler-Nichols (Z-N) 法、Cohen-Coon (C-C) 法等经典规则, 与现代优化法进行效果对比。
* **抗扰动性能仿真**：增加在系统中施加负载扰动的功能, 以测试参数的鲁棒性。